# VirtualAutoRace2025_System
 2025 8월에 주최한 가상환경 기반 자율주행 경진대회에 대한 git입니다. 
## 📌 소개
**목적 및 간략한 설명**  
저희는 자율주행 시뮬레이션 대회 환경에서 차량의 인지, 판단, 제어를 통합적으로 수행하기 위해 개발된 시스템입니다.  
ROS 기반으로 구성되었으며, 센서 데이터 처리 → 상황 판단 → 주행 제어까지 전체 파이프라인을 **FSM(유한 상태 기계, Finite State Machine)** 으로 구현하였습니다.  

## 🖥️ 시스템 설명
### 🔹 소프트웨어 구조도
<img width="1936" height="1151" alt="Image" src="https://github.com/user-attachments/assets/f0deb214-563d-40c4-bd29-8749927f464a" />

### 🔹 시스템 구조도
<img width="1271" height="705" alt="Image" src="https://github.com/user-attachments/assets/137cf063-5ba2-4eb4-a353-6e3dae0e7c96" />

### 🔹 파일 구조도
<img width="1171" height="528" alt="Image" src="https://github.com/user-attachments/assets/256f633c-b9ab-4a74-a4b3-06847d64583c" />

### 📝 시스템에 대한 설명

우리 시스템은 ROS의 통신 방식을 적극 활용하여 자율주행의 핵심 기능들을 모듈화하고 분리하여 설계하였습니다.  
센서로부터 입력되는 데이터를 **Perception(인지)** 모듈에서 처리하고, 이를 기반으로 **Decision(판단)** 모듈이 주행 전략을 결정합니다. 이 과정에서 두 모듈 간의 데이터 교환은 ROS의 **topic**을 통해 이루어지도록 구축하였습니다.  
한편, 실제 차량을 제어하는 **Controller(제어)** 모듈의 경우, ROS 통신을 별도로 두면 불필요한 오버헤드가 발생한다고 판단하여, Decision 모듈 내부에서 클래스를 직접 호출하여 활용하는 방식으로 구현하였습니다.  

---

시스템의 동작은 크게 **인지 → 판단 → 제어** 흐름으로 정리할 수 있습니다.  

- **인지(Perception)**: SLAM의 `amcl_pose` 값과 카메라, 라이다, 신호등 데이터를 활용하여 주행 환경을 인식합니다.  
- **판단(Decision)**: 인지된 정보를 기반으로 **FSM(유한 상태 기계, Finite State Machine)**을 이용하여 상황에 맞는 상태 전환을 수행합니다. 또한 `amcl_pose`는 FSM이 예기치 못하게 무너질 경우를 대비한 보조 장치로 사용됩니다.  
- **제어(Control)**: 차량 제어는 두 가지 방식으로 구현하였습니다. 하나는 차선을 기반으로 주행을 수행하는 방식이고, 다른 하나는 특정 상황에서 일정한 제어 값을 직접 전달하는 방식입니다. 이를 통해 다양한 주행 시나리오에 대응할 수 있도록 설계하였습니다.

## 실험 영상

### 전체 실험 영상

### 부분 실험 영상

## ✅ 잘한 점
- 모듈화된 구조로 유지보수 용이(이벤트 브로커 방식을 모방하였기에 가능한 일)
- ROS 기반으로 확장성과 재사용성이 높음  
- 시뮬레이터와 실제 차량 코드의 호환성을 고려한 설계  
- 다양한 테스트 환경에서 안정적으로 동작 확인(컴퓨터 성능에 따라 조금 달라지지만 괜찮다.)

## ⚠️ 아쉬웠던 부분
- SLAM에서 동작할 때 동적인 부분을 캐치 못하던것
- 대회 당일 날, 미션 1 위치를 재현하여 하지 못했던 것
- 컴퓨터 1대에서는 속도가 느려지면서 알고리즘이 제대로 동작하지 못하는 현상, 이러한 현상은 가끔 일어나는데 성능이 좋으면 안일어난다. 즉 매번 할때마다 하드코딩의 경우 상황이 달라질 수 있다.

### 🔧 개선 방향
- SLAM에서 동적을 처리하기 위해서 따로 라이다 값을 수정해서 넘겨주었거나, costmap을 잘 이용했다면 괜찮았을 수도 있다.
- 미션 1 환경을 미리 구축하고 실험했다면 동적으로 움직이는 물체에 부딛치는 상황을 볼 수 있었고, 이를 방지하도록 속도를 조절할 수 있었을 것이다.
- 컴퓨터를 2대인 환경에서 미리 설정을 하고 코드를 짜는게 좋다. 즉 미리미리 환경 구축하고, 대회에서 내가 한 값들을 빠르게 변화를 줄 수 있는 환경 구축이 핵심이었다. 이를 너무 늦게 알아서 아쉽넹

---

## 📜 라이센스
본 프로젝트는 **MIT License**를 따릅니다.  
이건 우리가 설정하면 된다. 아마 BSD3 던가가 많아서 그게 나을지도?
---

## 📂 참고한 Git
- [ROS 공식 GitHub](https://github.com/ros)  
- 다른 대회 자료
- [2023MORAIContest](https://github.com/lovelyoverflow/2023MORAIContest)  
- [MORAI-Contest](https://github.com/lococaeco/MORAI-Contest?tab=readme-ov-file)

---

## 👥 팀원 소개
- **박재일**: 미션 1 (SLAM & Nav)
- **이강태**: 미션 2 & 3 (동적, 정적 장애물 피하면서 주행)  
- **유태현**: 미션 2 & 3 (동적, 정적 장애물 피하면서 주행)
- **이선우**: 미션 4, 시스템 총괄 및 깃허브 관리 (로터리 주행)
- **하재민**: 미션 5, 차선 주행 알고리즘 구축 (신호등, 차선 따라 주행)
